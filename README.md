# Docker_memos
Данный репозиторий содержит пример сборки и работы с образами Docker.

<h2>Скрипт сборки образа <b>Dockfile</b></h2>
В файле Dockerfile находится скрипт сборки образа для Docker. 
Весь код:
<br>
<br>

<i><b>
FROM ubuntu:latest <br>
LABEL maintainer="gc986" <br>
RUN apt-get update  <br>
RUN apt-get upgrade -y <br>
RUN apt-get install -y openjdk-11-jdk <br>
COPY KtorTest ./server <br>
CMD cd server && ./gradlew run <br>
</b></i>

Разберём всё построчно:

<b>FROM ubuntu:latest</b>
Тег FROM, указывает базовый образ, на основе которого всё и будет строиться. За основу взят образ Ubuntu, причём самой последней версии которая есть в публичном репозитории Docker, об этом говорит надпись <i>latest</i>. При этом, можно точно указывать необходимую версию начального образа, например так <i>"FROM ubuntu:18.04"</i>

<b>LABEL maintainer="gc986"</b>
Тег LABEL предназначен для указания различных информационных меток, которые в дальнейшем будут определять данный образ. Метки могут быть совершенно разными.

<b>RUN apt-get update 
RUN apt-get upgrade -y
RUN apt-get install -y openjdk-11-jdk</b>

Тег RUN предназначен для запуска команд во время создания образа. Обычно с помощью этой команды доустанавливают пакеты необходимые для дальнейшей работы. В данном примере выполняются три команды, одна за другой: обновление репозитория, обновление системы, установка Java. Обратите внимание на ключ -y, он необходим чтобы соглашаться с вопросами которые могут возникнуть при установки пакетов. Если этого ключа не будет, то во время установки пакета не будет возможности принимать какие то условия (часто система стпрашивает пользователя, согласен ли он установить большой объём пакетов).

<b>COPY KtorTest ./server</b>
Тег COPY копирует указанную папку в рабочий каталог. COPY A B - копируем A в B. Причём, если папка назначения не существует, то она будет создана автоматически.

<b>CMD cd server && ./gradlew run</b>
Тег CMD необходим для запуска команд у запущенного контейнера. Эти команды не выполняются на этапе создания образа, в отличии он RUN. В частности в данном случае, происходит переход в папку проекта KtorTest и запуск gradlew файла с ключём run, который производит сборку проекта с последующим запуском.


<h2>Сборка Dockerfile образа</h2>
Чтобы собрать образ, нужно в корне проекта (где находится файл Dockerfile) выполнить команду: <i>docker build . -t test-image</i>
Образ будет создан и помещён в локальный репозиторий.

<h2>Запуск только что созданного образа</h2>
Образ запускается с помощью команды: <i>docker run --name KTor -p 8080:8080 test-image</i>
Помимо запуска образа test-image, данная команда перебрасывает порты которые будут запущены в контейнере, на порты локальной машины (-p 8080:8080). Ещё, нзначается имя для запущенного контейнера (--name KTor).
